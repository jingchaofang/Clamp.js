<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
<style>
/*

Original highlight.js style (c) Ivan Sagalaev <maniac@softwaremaniacs.org>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #F0F0F0;
}


/* Base color: saturation 0; */

.hljs,
.hljs-subst {
  color: #444;
}

.hljs-comment {
  color: #888888;
}

.hljs-keyword,
.hljs-attribute,
.hljs-selector-tag,
.hljs-meta-keyword,
.hljs-doctag,
.hljs-name {
  font-weight: bold;
}


/* User color: hue: 0 */

.hljs-type,
.hljs-string,
.hljs-number,
.hljs-selector-id,
.hljs-selector-class,
.hljs-quote,
.hljs-template-tag,
.hljs-deletion {
  color: #880000;
}

.hljs-title,
.hljs-section {
  color: #880000;
  font-weight: bold;
}

.hljs-regexp,
.hljs-symbol,
.hljs-variable,
.hljs-template-variable,
.hljs-link,
.hljs-selector-attr,
.hljs-selector-pseudo {
  color: #BC6060;
}


/* Language color: hue: 90; */

.hljs-literal {
  color: #78A960;
}

.hljs-built_in,
.hljs-bullet,
.hljs-code,
.hljs-addition {
  color: #397300;
}


/* Meta color: hue: 200 */

.hljs-meta {
  color: #1f7199;
}

.hljs-meta-string {
  color: #4d99bf;
}


/* Misc effects */

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}

</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>
hljs.initHighlightingOnLoad();
</script>
<title>字符串截取打点</title>
<style>
* {
    margin: 0;
    padding: 0;
}

@media(min-width: 414px) {
    body {
        width: 366px;
        margin: 0 auto;
    }
}

@media(max-width: 414px) {
    body {
        margin: 0 auto;
        padding: 24px;
    }
}

section {
    font-size: 14px;
    color: #000;
    margin: 24px 0;
}

p {
    padding: 6px;
}

.ellipsis {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
}

.clamp {
    text-overflow: ellipsis;
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
}

.clamp1 {
    -webkit-line-clamp: 1;
}

.clamp2 {
    -webkit-line-clamp: 2;
}

.tag {
    display: inline-block;
    padding: 0 8px;
    height: 20px;
    line-height: 21px;
    font-size: 11px;
    color: rgba(54, 58, 61, 0.35);
    border: 1px solid;
    position: relative;
    border-radius: 4px;
    vertical-align: bottom;
    white-space: nowrap;
    margin: 10px 8px 0 0;
}

.triangle {
    display: inline-block;
    position: relative;
    float: right;
    width: 8px;
    height: 8px;
}

.triangle::before {
    content: '';
    position: absolute;
    display: inline-block;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    border: 4px solid;
}

.down {
    margin: 10px 10px 0;
}

.up {
    margin: 6px 10px 0;
}

.down::before {
    border-color: #000 transparent transparent;
    vertical-align: -0.25ex;
}

.up::before {
    border-color: transparent transparent #000;
    vertical-align: 0.25ex;
}

.tags {
    overflow: hidden;
    height: 32px;
}
</style>
</head>

<body>
<figure>
<p>css语法限制2行打点</p>
<pre><code class="css">.clamp {
text-overflow: ellipsis;
overflow: hidden;
display: -webkit-box;
-webkit-box-orient: vertical;
}
.clamp2 {
-webkit-line-clamp: 2;
}
</code></pre>
    <section class="clamp clamp2">
        一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本
    </section>
</figure>
<figure>
    <p>css语法限制1行打点</p>
    <pre><code class="css">.ellipsis {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
}
</code></pre>
    <section class="ellipsis">
        一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本
    </section>
</figure>
<figure>
    <p>css语法限制1行打点</p>
    <pre><code class="css">.clamp {
    text-overflow: ellipsis;
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
}
.clamp1 {
    -webkit-line-clamp: 1;
}
</code></pre>
    <section class="clamp clamp1">
        一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本一段很长的文本
    </section>
</figure>
<figure>
    <p>包裹元素不定高clamp.zepto.js截取并拼接片段，不定高容易出现大幅度闪动，影响体验</p>
    <pre><code class="javascript">var $intro1 = $('#intro1');
var clampResult1 = $intro1.clamp({
    clamp: 3,
    truncationHTML: '...'
});
</code></pre>
    <section>
        <div id="intro1" style="overflow: hidden;line-height:20px;">佟一琮家里祖辈都是玉匠，可是他父亲佟瑞国却反对他碰玉，但又将他抓周时的那块玉系着红绳，栓在他的脖子上。告诉他要善待这块玉，玉是通灵的，救得了人的性命。佟一琮母亲对他的女朋友程小瑜有一种天然的不信任。佟一琮与程小瑜草草结婚后去了上海打工。程小瑜进了外企，事业发展得很好，而佟一琮痴迷于玉，不安心于现在的工作，听说玉王要运往鞍山雕成玉佛，佟一琮执意要回去，为玉佛送行。两人的关系渐行渐远，终于，程小瑜投入了一位成功男人的怀抱。佟一琮出没于全国各大玉器市场，认识了一位老板步凡。佟一琮渐渐懂得，真正的好作品，卖的是艺，不是玉。而这艺的内容就多了。不能就玉而玉，地质学、古玩、根雕、外国美术、佛学、儒学、道家等等，各方面都要学习。佟一琮自此真正入了道，在玉行里浸淫，在商场上拼杀，最终成为了业界赫赫有名的玉雕大师、玉王，并找到了自己心爱之人……本书通过一个玉石大师的成长奋斗和爱恨情仇，侧面展现了一个令人惊叹的玉器古玩世界；以及玩玉、赏玉的知识；以及这个行业里面的各种规则、陷阱；以及人与人之间各种错综复杂的关系。</div>
    </section>
</figure>
<figure>
    <p>包裹元素定高clamp.zepto.js截取并拼接片段</p>
    <pre><code class="javascript">var $intro2 = $('#intro2');
var clampResult2 = $intro2.clamp({
    hasHeight: true,
    truncationHTML: '...'
});
</code></pre>
    <section>
        <div id="intro2" style="overflow: hidden;height: 60px;line-height: 20px;">佟一琮家里祖辈都是玉匠，可是他父亲佟瑞国却反对他碰玉，但又将他抓周时的那块玉系着红绳，栓在他的脖子上。告诉他要善待这块玉，玉是通灵的，救得了人的性命。佟一琮母亲对他的女朋友程小瑜有一种天然的不信任。佟一琮与程小瑜草草结婚后去了上海打工。程小瑜进了外企，事业发展得很好，而佟一琮痴迷于玉，不安心于现在的工作，听说玉王要运往鞍山雕成玉佛，佟一琮执意要回去，为玉佛送行。两人的关系渐行渐远，终于，程小瑜投入了一位成功男人的怀抱。佟一琮出没于全国各大玉器市场，认识了一位老板步凡。佟一琮渐渐懂得，真正的好作品，卖的是艺，不是玉。而这艺的内容就多了。不能就玉而玉，地质学、古玩、根雕、外国美术、佛学、儒学、道家等等，各方面都要学习。佟一琮自此真正入了道，在玉行里浸淫，在商场上拼杀，最终成为了业界赫赫有名的玉雕大师、玉王，并找到了自己心爱之人……本书通过一个玉石大师的成长奋斗和爱恨情仇，侧面展现了一个令人惊叹的玉器古玩世界；以及玩玉、赏玉的知识；以及这个行业里面的各种规则、陷阱；以及人与人之间各种错综复杂的关系。</div>
    </section>
</figure>
<figure>
    <p>包裹元素定高clamp.zepto.js截取并拼接片段</p>
    <pre><code class="javascript">var $tag3 = $('#tag3');
var $intro3 = $('#intro3');
var clampResult3 = $intro3.clamp({
    hasHeight: true,
    truncationHTML: '...'
});

if ($intro3.data('clamp') || $tag3.get(0).scrollHeight > $tag3.get(0).clientHeight) {
    $intro3.on('click', function() {
        if($(this).data('clamp')) {
            $intro3.html(clampResult3.original + '...');
            $intro3.css({ 'height': 'auto' });
            $tag3.css({ 'height': 'auto' });
            $(this).data('clamp', false);
        } else {
            $intro3.html(clampResult3.clamped);
            $intro3.css({ 'height': '' });
            $tag3.css({ 'height': '' });
            $(this).data('clamp', true);
        }
    });
}
</code></pre>
    <section>
        <div id="intro3" style="overflow: hidden;height: 60px;line-height: 20px">佟一琮家里祖辈都是玉匠，可是他父亲佟瑞国却反对他碰玉，但又将他抓周时的那块玉系着红绳，栓在他的脖子上。告诉他要善待这块玉，玉是通灵的，救得了人的性命。佟一琮母亲对他的女朋友程小瑜有一种天然的不信任。佟一琮与程小瑜草草结婚后去了上海打工。程小瑜进了外企，事业发展得很好，而佟一琮痴迷于玉，不安心于现在的工作，听说玉王要运往鞍山雕成玉佛，佟一琮执意要回去，为玉佛送行。两人的关系渐行渐远，终于，程小瑜投入了一位成功男人的怀抱。佟一琮出没于全国各大玉器市场，认识了一位老板步凡。佟一琮渐渐懂得，真正的好作品，卖的是艺，不是玉。而这艺的内容就多了。不能就玉而玉，地质学、古玩、根雕、外国美术、佛学、儒学、道家等等，各方面都要学习。佟一琮自此真正入了道，在玉行里浸淫，在商场上拼杀，最终成为了业界赫赫有名的玉雕大师、玉王，并找到了自己心爱之人……本书通过一个玉石大师的成长奋斗和爱恨情仇，侧面展现了一个令人惊叹的玉器古玩世界；以及玩玉、赏玉的知识；以及这个行业里面的各种规则、陷阱；以及人与人之间各种错综复杂的关系。</div>
        <div id="tag3" class="tags" style="height: auto;">
            <span class="tag">村上春树</span>
            <span class="tag">村上春树</span>
            <span class="tag">日本文学</span>
            <span class="tag">超现实</span>
            <span class="tag">现代</span>
            <span class="tag">现代</span>
        </div>
    </section>
</figure>
<figure>
<pre><code>/**
 * 标签有隐藏内容
 */
var $tag4 = $('#tag4');
var $intro4 = $('#intro4');
var clampResult4 = $intro4.clamp({
    hasHeight: true,
    truncationHTML: '...',
    force: $tag4.get(0).scrollHeight > $tag4.get(0).clientHeight ? true : false
});

if ($intro4.data('clamp') || $tag4.get(0).scrollHeight > $tag4.get(0).clientHeight) {
    $intro4.on('click', function() {
        if ($(this).data('clamp')) {
            $intro4.html(clampResult4.original + '...');
            $intro4.css({ 'height': 'auto' });
            $tag4.css({ 'height': 'auto' });
            $(this).data('clamp', false);
        } else {
            $intro4.html(clampResult4.clamped);
            $intro4.css({ 'height': '' });
            $tag4.css({ 'height': '' });
            $(this).data('clamp', true);
        }
    });
}
</code></pre>
    <section>
        <div id="intro4" style="overflow: hidden;height: 60px;line-height: 20px">df赏玉的知识；以及这个行业里面的各种规则、陷阱；以及人与人之间各种错综复杂的关系。之间各种错综复杂的关系之间各种错综复杂的关系之间各种错综复杂的关系之间各种</div>
        <div id="tag4" class="tags">
            <span class="tag">村上春树</span>
            <span class="tag">村上春树</span>
            <span class="tag">日本文学</span>
            <span class="tag">超现实</span>
            <span class="tag">现代</span>
            <span class="tag">现代</span>
        </div>
    </section>
</figure>
<figure>
    <pre><code>/**
 * 标签有隐藏内容
 */
var $tag5 = $('#tag5');
var $intro5 = $('#intro5');
var clampResult5 = $intro5.clamp({
    hasHeight: true,
    truncationHTML: '...',
    force: $tag5.get(0).scrollHeight > $tag5.get(0).clientHeight ? true : false
});
if ($intro5.data('clamp') || $tag5.get(0).scrollHeight > $tag5.get(0).clientHeight) {
    $intro5.on('click', function() {
        if ($(this).data('clamp')) {
            $intro5.html(clampResult5.original + '...');
            $intro5.css({ 'height': 'auto' });
            $tag5.css({ 'height': 'auto' });
            $(this).data('clamp', false);
        } else {
            $intro5.html(clampResult5.clamped);
            $intro5.css({ 'height': '' });
            $tag5.css({ 'height': '' });
            $(this).data('clamp', true);
        }
    });
}
</code></pre>
    <section>
        <div id="intro5" style="overflow:hidden;height:60px;line-height:20px;">之间各种错综复杂的关系之间各种错综复杂的关系之间各种错综复杂的关系之间各种</div>
        <div id="tag5" class="tags">
            <span class="tag">村上春树</span>
            <span class="tag">村上春树</span>
            <span class="tag">日本文学</span>
            <span class="tag">超现实</span>
            <span class="tag">现代</span>
            <span class="tag">现代</span>
        </div>
    </section>
</figure>
<figure>
    <pre><code>/**
 * 对多个元素文本截取
 */
var $intros = $('.intros');
for (var i = 0; i < $intros.length; i++) {
    $intros.eq(i).clamp({
        hasHeight: true,
        truncationHTML: '...'
    });
}
</code></pre>
    <section>
        <div class="intros" style="overflow: hidden;height: 60px;line-height: 20px">
            佟一琮家里祖辈都是玉匠，可是他父亲佟瑞国却反对他碰玉，但又将他抓周时的那块玉系着红绳，栓在他的脖子上。告诉他要善待这块玉，玉是通灵的，救得了人的性命。佟一琮母亲对他的女朋友程小瑜有一种天然的不信任。佟一琮与程小瑜草草结婚后去了上海打工。程小瑜进了外企，事业发展得很好，而佟一琮痴迷于玉，不安心于现在的工作，听说玉王要运往鞍山雕成玉佛，佟一琮执意要回去，为玉佛送行。两人的关系渐行渐远，终于，程小瑜投入了一位成功男人的怀抱。佟一琮出没于全国各大玉器市场，认识了一位老板步凡。佟一琮渐渐懂得，真正的好作品，卖的是艺，不是玉。而这艺的内容就多了。不能就玉而玉，地质学、古玩、根雕、外国美术、佛学、儒学、道家等等，各方面都要学习。佟一琮自此真正入了道，在玉行里浸淫，在商场上拼杀，最终成为了业界赫赫有名的玉雕大师、玉王，并找到了自己心爱之人……本书通过一个玉石大师的成长奋斗和爱恨情仇，侧面展现了一个令人惊叹的玉器古玩世界；以及玩玉、赏玉的知识；以及这个行业里面的各种规则、陷阱；以及人与人之间各种错综复杂的关系。
        </div>
    </section>
    <section>
        <div class="intros" style="overflow: hidden;height: 60px;line-height: 20px">
            佟一琮家里祖辈都是玉匠，可是他父亲佟瑞国却
        </div>
    </section>
    <section>
        <div class="intros" style="overflow: hidden;height: 60px;line-height: 20px">
            佟一琮家里祖辈都是玉匠，可是他父亲佟瑞国却反对他碰玉，但又将他抓周时的那块玉系着红绳，栓在他的脖子上。告诉他要善待这块玉，玉是通灵的，救得了人的性命。佟一琮母亲对他的女朋友程小瑜有一种天然的不信任。佟一琮与程小瑜草草结婚后去了上海打工。程小瑜进了外企，事业发展得很好，而佟一琮痴迷于玉，不安心于现在的工作，听说玉王要运往鞍山雕成玉佛，佟一琮执意要回去，为玉佛送行。两人的关系渐行渐远，终于，程小瑜投入了一位成功男人的怀抱。佟一琮出没于全国各大玉器市场，认识了一位老板步凡。佟一琮渐渐懂得，真正的好作品，卖的是艺，不是玉。而这艺的内容就多了。不能就玉而玉，地质学、古玩、根雕、外国美术、佛学、儒学、道家等等，各方面都要学习。佟一琮自此真正入了道，在玉行里浸淫，在商场上拼杀，最终成为了业界赫赫有名的玉雕大师、玉王，并找到了自己心爱之人……本书通过一个玉石大师的成长奋斗和爱恨情仇，侧面展现了一个令人惊叹的玉器古玩世界；以及玩玉、赏玉的知识；以及这个行业里面的各种规则、陷阱；以及人与人之间各种错综复杂的关系。
        </div>
    </section>
</figure>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
<script src="../clamp.zepto.js"></script>
<script>
$(function() {

/**
 * 包裹元素不定高
 */
var $intro1 = $('#intro1');
var clampResult1 = $intro1.clamp({
    clamp: 3,
    truncationHTML: '...<span class="triangle down"></span>'
});

/**
 * 包裹元素定高
 */
var $intro2 = $('#intro2');
var clampResult2 = $intro2.clamp({
    hasHeight: true,
    truncationHTML: '...<span class="triangle down"></span>'
});

/**
 * 标签有隐藏内容
 */
var $tag3 = $('#tag3');
var $intro3 = $('#intro3');
var clampResult3 = $intro3.clamp({
    hasHeight: true,
    truncationHTML: '...<span class="triangle down"></span>'
});

if ($intro3.data('clamp')) {
    $intro3.on('click', function() {
        if ($(this).data('clamp')) {
            $intro3.html(clampResult3.original + '<span class="triangle up"></span>');
            $intro3.css({ 'height': 'auto' });
            $(this).data('clamp', false);
        } else {
            $intro3.html(clampResult3.clamped);
            $intro3.css({ 'height': '' });
            $(this).data('clamp', true);
        }
    });
}

/**
 * 标签有隐藏内容
 */
var $tag4 = $('#tag4');
var $intro4 = $('#intro4');
var clampResult4 = $intro4.clamp({
    hasHeight: true,
    truncationHTML: '...<span class="triangle down"></span>',
    force: $tag4.get(0).scrollHeight > $tag4.get(0).clientHeight ? true : false
});

if ($intro4.data('clamp') || $tag4.get(0).scrollHeight > $tag4.get(0).clientHeight) {
    $intro4.on('click', function() {
        if ($(this).data('clamp')) {
            $intro4.html(clampResult4.original + '<span class="triangle up"></span>');
            $intro4.css({ 'height': 'auto' });
            $tag4.css({ 'height': 'auto' });
            $(this).data('clamp', false);
        } else {
            $intro4.html(clampResult4.clamped);
            $intro4.css({ 'height': '' });
            $tag4.css({ 'height': '' });
            $(this).data('clamp', true);
        }
    });
}

/**
 * 标签有隐藏内容
 */
var $tag5 = $('#tag5');
var $intro5 = $('#intro5');
var clampResult5 = $intro5.clamp({
    hasHeight: true,
    truncationHTML: '...<span class="triangle down"></span>',
    force: $tag5.get(0).scrollHeight > $tag5.get(0).clientHeight ? true : false
});
if ($intro5.data('clamp') || $tag5.get(0).scrollHeight > $tag5.get(0).clientHeight) {
    $intro5.on('click', function() {
        if ($(this).data('clamp')) {
            $intro5.html(clampResult5.original + '<span class="triangle up"></span>');
            $intro5.css({ 'height': 'auto' });
            $tag5.css({ 'height': 'auto' });
            $(this).data('clamp', false);
        } else {
            $intro5.html(clampResult5.clamped);
            $intro5.css({ 'height': '' });
            $tag5.css({ 'height': '' });
            $(this).data('clamp', true);
        }
    });
}

/**
 * 对多个元素文本截取
 */
var $intros = $('.intros');
for (var i = 0; i < $intros.length; i++) {
    $intros.eq(i).clamp({
        hasHeight: true,
        truncationHTML: '...<span class="triangle down"></span>'
    });
}

});
</script>

</html>